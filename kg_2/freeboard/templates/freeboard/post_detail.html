<!-- freeboard/templates/freeboard/post_detail.html -->
<!-- 게시글 상세 + 댓글 -->
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>{{ post.title }}</title>
</head>
<body>
    <h2>{{ post.title }}</h2>
    <p>작성자: {{ post.author }} | 작성일: {{ post.created_at|date:"Y-m-d H:i" }}</p>
    <p>{{ post.content|linebreaks }}</p>

    {% if request.user == post.author %}
        <a href="{% url 'freeboard:post_edit' post.pk %}">수정</a>
        <a href="{% url 'freeboard:post_delete' post.pk %}" onclick="return confirm('정말 삭제할까요?')">삭제</a>
    {% endif %}
    <a href="{% url 'freeboard:freeboard_list' %}">목록</a>

    <hr>
    <h3>댓글</h3>

    {% for comment in comments %}
        <div>
            <p>{{ comment.content|linebreaks }}</p>
            <small>{{ comment.author }} | {{ comment.created_at|date:"Y-m-d H:i" }}</small>
            {% if request.user == comment.author %}
                <a href="{% url 'freeboard:comment_delete' comment.id %}" onclick="return confirm('댓글 삭제할까요?')">삭제</a>
            {% endif %}
        </div>
        <hr>
    {% empty %}
        <p>아직 댓글이 없습니다.</p>
    {% endfor %}

    {% if request.user.is_authenticated %}
        <form method="post">
            {% csrf_token %}
            {{ comment_form.as_p }}
            <button type="submit">댓글 작성</button>
        </form>
    {% else %}
        <p><a href="{% url 'common:login' %}">로그인</a> 후 댓글을 작성할 수 있습니다.</p>
    {% endif %}
</body>
</html>
